import{E as e,a as t,G as a,H as o,J as n}from"./ant-design-vue-ceZujQnV.js";import{r as s,e as i,H as r,d as l,o as c,V as d,k as g,a1 as u,u as p,W as h}from"./vue-vendor-CFnyIo_N.js";import{r as m}from"./index-BONNjK7n.js";const y=()=>{const o=s({rowSelectionType:"checkbox",extraParams:{},loading:!1,batchExportLoading:!1,dataList:[],pageNum:1,pageSize:10,rowKey:"id",totalLength:0,totalPages:0,curSelectKeys:[],curSelectRows:[],totalSelectedKeys:[],searchParams:{},getListCallback:void 0});let n=null;let l=null;const c=i(()=>({fixed:!0,selectedRowKeys:o.curSelectKeys,onChange:(e,t)=>{o.curSelectKeys=[...e],o.curSelectRows=t,o.totalSelectedKeys=[...e]},type:o.rowSelectionType}));async function d(t=!0,a=!0,i){if(i=i||o.getListCallback,t&&(o.pageNum=1),a&&g(),!n||"function"!=typeof n)throw new Error("请在使用的组件data中声明数据请求方法");if(!o.searchParams)throw new Error("请在使用的组件data中声明searchParams字段");const r=e(o.searchParams);o.loading=!0;try{const e=await n({...r,pageNum:o.pageNum,pageSize:o.pageSize});o.loading=!1;const{total:a,items:l}=e.result;if(0===l.length&&1!==o.pageNum)return o.pageNum--,void d(t);o.dataList=l,o.totalLength=a,i&&"function"==typeof i&&i(s(e))}finally{o.loading=!1}}function g(){o.curSelectKeys=[],o.totalSelectedKeys=[]}return i(()=>o.dataList.map(e=>e[o.rowKey])||[]),{...r(o),rowSelection:c,setRowKey:function(e){o.rowKey=e},ajaxFunc:n,setAjaxFunc:function(e){n=e},batchExport:async function(){if(0!==o.totalSelectedKeys.length){if(o.batchExportLoading=!0,!l||"function"!=typeof l)throw new Error("请在使用的组件data中声明数据请求方法");try{const e=await l({ids:o.totalSelectedKeys,type:1});((e,t="")=>{const a=new Blob([e]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,t);else{const e=document.createElement("a");e.download=t,e.style.display="none",e.href=URL.createObjectURL(a),document.body.appendChild(e),e.click(),document.body.removeChild(e)}})(e,a().format("YYYY-MM-DD HH:mm")+".xlsx"),g()}catch(e){}finally{o.batchExportLoading=!1}}else t.warning("请至少选择一条数据")},setExportFile:function(e){l=e},getNewsList:d,pageChange:function(e){o.pageNum=e,d(!1,!1)},pageSizeChange:function(e,t){o.pageSize=t,d(!1)}}};function w(e){return m.get("/tableList",{params:e})}const f={class:"w-full"},S={class:"text-center mt-4 pt-3"},x=l({__name:"Index",setup(e){const t=[{title:"姓名",dataIndex:"name",key:"name"},{title:"年龄",dataIndex:"age",key:"age"},{title:"住址",dataIndex:"address",key:"address"},{title:"电话号码",dataIndex:"phone",key:"phone"},{title:"职业",dataIndex:"profession",key:"profession"}],{dataList:a,pageNum:s,pageSize:i,totalLength:r,pageChange:l,pageSizeChange:m,setAjaxFunc:x,getNewsList:K,loading:L,rowSelection:b,rowKey:z}=y();return x(w),c(()=>{K()}),(e,c)=>{const y=o,w=n;return h(),d("div",f,[g(y,{dataSource:p(a),columns:t,loading:p(L),pagination:!1,"row-selection":p(b),rowKey:p(z)},null,8,["dataSource","loading","row-selection","rowKey"]),u("div",S,[g(w,{ref:"paginationElem","show-quick-jumper":"","show-size-changer":"",current:p(s),"show-total":e=>`共 ${e} 条`,pageSize:p(i),pageSizeOptions:["10","20","30","40","50"],total:p(r),onChange:p(l),onShowSizeChange:p(m)},null,8,["current","show-total","pageSize","total","onChange","onShowSizeChange"])])])}}});export{x as default};
